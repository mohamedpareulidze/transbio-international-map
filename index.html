<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Carte Interactive des Institutions Partenaires</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        .container { display: flex; padding: 20px; }
        .filters { width: 200px; margin-right: 20px; background: #f5f5f5; padding: 10px; border-radius: 5px; }
        .filters select { width: 100%; margin-bottom: 10px; padding: 5px; }
        .map { flex-grow: 1; height: 80vh; }
        .info { margin-bottom: 10px; }
        .popup-content { max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="info">
        Explorez les partenariats internationaux de la Graduate School Transbio à travers le monde. Utilisez les filtres ci-dessous pour affiner votre recherche.
    </div>
    <div class="container">
        <div class="filters">
            <h3>Filtres</h3>
            <select id="programLevelFilter">
                <option value="all">Tous</option>
                <option value="Master">Master</option>
                <option value="Laboratory">Laboratory</option>
            </select>
            <select id="countryFilter">
                <option value="all">Tous</option>
                <option value="Germany">Germany</option>
                <option value="Belgium">Belgium</option>
                <option value="Spain">Spain</option>
                <option value="Austria">Austria</option>
                <option value="Finland">Finland</option>
                <option value="Croatia">Croatia</option>
                <option value="Sweden">Sweden</option>
                <option value="Armenia">Armenia</option>
                <option value="Czech Republic">Czech Republic</option>
                <option value="Turkey">Turkey</option>
                <option value="United Kingdom">United Kingdom</option>
                <option value="France">France</option>
                <option value="Italy">Italy</option>
            </select>
            <select id="agreementTypeFilter">
                <option value="all">Tous</option>
                <option value="Erasmus+">Erasmus+</option>
                <option value="Double degree">Double degree</option>
            </select>
            <div>La carte affiche tous nos partenariats actifs. Cliquez sur un marqueur pour voir plus de détails sur le partenariat.</div>
        </div>
        <div id="map" class="map"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Hardcoded data from Relations-Internationales.csv
        const partners = [
            { "Related Program Level": "Master", "Related Program Name": "Physiological and Psychological Food Choice Determinants (P²FOOD)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Exchange program in food science", "International Agreement": "Erasmus+", "latitude": 48.710896, "longitude": 9.2094133 },
            { "Related Program Level": "Master", "Related Program Name": "Physiological and Psychological Food Choice Determinants (P²FOOD)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Université de Liège / Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Exchange program in food science", "International Agreement": "Erasmus+", "latitude": 50.5616029, "longitude": 4.6936392 },
            { "Related Program Level": "Master", "Related Program Name": "Physiological and Psychological Food Choice Determinants (P²FOOD)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Universidad Politecnica De Valencia", "Partner Country": "Spain", "Partner City": "Valencia", "Partner Program": "Exchange program in food science", "International Agreement": "Erasmus+", "latitude": 39.4807383, "longitude": -0.3436707 },
            { "Related Program Level": "Master", "Related Program Name": "Physiological and Psychological Food Choice Determinants (P²FOOD)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "University of Bonn", "Partner Country": "Germany", "Partner City": "Bonn", "Partner Program": "Exchange program in food science", "International Agreement": "Erasmus+", "latitude": 50.7267847, "longitude": 7.0838779 },
            { "Related Program Level": "Master", "Related Program Name": "Microbiology and Physicochemistry for food and wine Processes (MP²)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Exchange program in food science/microbiology", "International Agreement": "Erasmus+", "latitude": 48.7108967, "longitude": 9.2094133 },
            { "Related Program Level": "Master", "Related Program Name": "Microbiology and Physicochemistry for food and wine Processes (MP²)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Université de Liège / Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Exchange program in food science/microbiology", "International Agreement": "Erasmus+", "latitude": 50.5616029, "longitude": 4.6936392 },
            { "Related Program Level": "Master", "Related Program Name": "Microbiology and Physicochemistry for food and wine Processes (MP²)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Universidad de Córdoba", "Partner Country": "Spain", "Partner City": "Córdoba", "Partner Program": "Exchange program in food science/microbiology", "International Agreement": "Erasmus+", "latitude": 37.8835595, "longitude": -4.8076616 },
            { "Related Program Level": "Master", "Related Program Name": "Microbiology and Physicochemistry for food and wine Processes (MP²)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "University of Natural Resources and Life Sciences, Vienna (BOKU)", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Exchange program in food science/microbiology", "International Agreement": "Erasmus+", "latitude": 48.2365483, "longitude": 16.3350041 },
            { "Related Program Level": "Master", "Related Program Name": "Biodiversité et Changements Anthropiques : écologie, évolution, gestion (BCA)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Helsinki", "Partner Country": "Finland", "Partner City": "Helsinki", "Partner Program": "Exchange program in ecology/biodiversity", "International Agreement": "Erasmus+", "latitude": 60.1674881, "longitude": 24.9427473 },
            { "Related Program Level": "Master", "Related Program Name": "Biodiversité et Changements Anthropiques : écologie, évolution, gestion (BCA)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Ghent University", "Partner Country": "Belgium", "Partner City": "Ghent", "Partner Program": "Exchange program in ecology/biodiversity", "International Agreement": "Erasmus+", "latitude": 51.0538286, "longitude": 3.7250121 },
            { "Related Program Level": "Master", "Related Program Name": "Biodiversité et Changements Anthropiques : écologie, évolution, gestion (BCA)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Zagreb", "Partner Country": "Croatia", "Partner City": "Zagreb", "Partner Program": "Exchange program in ecology/biodiversity", "International Agreement": "Erasmus+", "latitude": 45.8130967, "longitude": 15.9772795 },
            { "Related Program Level": "Master", "Related Program Name": "Biodiversité et Changements Anthropiques : écologie, évolution, gestion (BCA)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Natural Resources and Life Sciences, Vienna (BOKU)", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Exchange program in ecology/biodiversity", "International Agreement": "Erasmus+", "latitude": 48.2365483, "longitude": 16.3350041 },
            { "Related Program Level": "Master", "Related Program Name": "Archéologie du Bâti (parcours ArBa)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Vienna", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Archaeology", "International Agreement": "Erasmus+", "latitude": 48.2083537, "longitude": 16.3725042 },
            { "Related Program Level": "Master", "Related Program Name": "Archéologie, culture, territoires, environnement - Archéo-Géo-Sciences (parcours AGES)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Vienna", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Prehistoric and Historical Archaeology", "International Agreement": "Erasmus+", "latitude": 48.2083537, "longitude": 16.3725042 },
            { "Related Program Level": "Master", "Related Program Name": "Archéologie, culture, territoires, environnement - Archéo-Géo-Sciences (parcours AGES)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Barcelona", "Partner Country": "Spain", "Partner City": "Barcelona", "Partner Program": "Prehistory", "International Agreement": "Erasmus+", "latitude": 41.3866764, "longitude": 2.1612912 },
            { "Related Program Level": "Master", "Related Program Name": "Microbiologie, résistance antimicrobienne, génomique, épidémiologie (MAGE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Vienna", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Microbiology and Immunology", "International Agreement": "Erasmus+", "latitude": 48.2083537, "longitude": 16.3725042 },
            { "Related Program Level": "Master", "Related Program Name": "Microbiologie, résistance antimicrobienne, génomique, épidémiologie (MAGE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Barcelona", "Partner Country": "Spain", "Partner City": "Barcelona", "Partner Program": "Microbiology", "International Agreement": "Erasmus+", "latitude": 41.3866764, "longitude": 2.1612912 },
            { "Related Program Level": "Master", "Related Program Name": "Sédimentologie, Paléontologie, Géochimie, Géoressources (SP2G)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Vienna", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Geology and Paleontology", "International Agreement": "Erasmus+", "latitude": 48.2083537, "longitude": 16.3725042 },
            { "Related Program Level": "Master", "Related Program Name": "Sédimentologie, Paléontologie, Géochimie, Géoressources (SP2G)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Barcelona", "Partner Country": "Spain", "Partner City": "Barcelona", "Partner Program": "Stratigraphy, Paleontology, and Earth Sciences", "International Agreement": "Erasmus+", "latitude": 41.3866764, "longitude": 2.1612912 },
            { "Related Program Level": "Master", "Related Program Name": "Sol, Eau, Milieux, Environnement (SEME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "University of Vienna", "Partner Country": "Austria", "Partner City": "Vienna", "Partner Program": "Environmental Geosciences", "International Agreement": "Erasmus+", "latitude": 48.2083537, "longitude": 16.3725042 },
            { "Related Program Level": "Master", "Related Program Name": "Sol, Eau, Milieux, Environnement (SEME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "University of Barcelona", "Partner Country": "Spain", "Partner City": "Barcelona", "Partner Program": "Geography and Environmental Sciences", "International Agreement": "Erasmus+", "latitude": 41.3866764, "longitude": 2.1612912 },
            { "Related Program Level": "Master", "Related Program Name": "Qualité des Eaux, Sols et Traitements (QuEST)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Chalmers University of Technology", "Partner Country": "Sweden", "Partner City": "Gothenburg", "Partner Program": "Master's programs in Food processing and Chemistry", "International Agreement": "Erasmus+", "latitude": 57.7072326, "longitude": 11.9670171 },
            { "Related Program Level": "Master", "Related Program Name": "Qualité des Eaux, Sols et Traitements (QuEST)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.1800132 },
            { "Related Program Level": "Master", "Related Program Name": "Qualité des Eaux, Sols et Traitements (QuEST)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Université de Liège Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Master's programs in Chemical engineering and processes/Food processing", "International Agreement": "Erasmus+", "latitude": 50.5597273, "longitude": 4.6943126 },
            { "Related Program Level": "Master", "Related Program Name": "Biologie Intégrative et Interactions Plante-Microbe-Environnement (B2IPME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Yerevan State University", "Partner Country": "Armenia", "Partner City": "Yerevan", "Partner Program": "Master's in Biology and Physico-Chemistry", "International Agreement": "Double degree", "latitude": 40.1777112, "longitude": 44.5126233 },
            { "Related Program Level": "Master", "Related Program Name": "Biologie Intégrative et Interactions Plante-Microbe-Environnement (B2IPME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Chemistry and Technology UCT Prague", "Partner Country": "Czech Republic", "Partner City": "Prague", "Partner Program": "Master's programs in Natural sciences, mathematics and statistics/Engineering, manufacturing and construction", "International Agreement": "Erasmus+", "latitude": 50.0874654, "longitude": 14.4212535 },
            { "Related Program Level": "Master", "Related Program Name": "Ecology Monitoring and Management of Ecosystems (EMME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.1800132 },
            { "Related Program Level": "Master", "Related Program Name": "Ecology Monitoring and Management of Ecosystems (EMME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Université de Liège Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Master's programs in Chemical engineering and processes/Food processing", "International Agreement": "Erasmus+", "latitude": 50.5597273, "longitude": 4.6943126 },
            { "Related Program Level": "Master", "Related Program Name": "Ecology Monitoring and Management of Ecosystems (EMME)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Chalmers University of Technology", "Partner Country": "Sweden", "Partner City": "Gothenburg", "Partner Program": "Master's programs in Food processing and Chemistry", "International Agreement": "Erasmus+", "latitude": 57.7072326, "longitude": 11.9670171 },
            { "Related Program Level": "Master", "Related Program Name": "M1 : Ingénierie de l’environnement et des territoires (IET)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Chalmers University of Technology", "Partner Country": "Sweden", "Partner City": "Gothenburg", "Partner Program": "Master's programs in Food processing and Chemistry", "International Agreement": "Erasmus+", "latitude": 57.7072326, "longitude": 11.9670171 },
            { "Related Program Level": "Master", "Related Program Name": "M1 : Ingénierie de l’environnement et des territoires (IET)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.18001327 },
            { "Related Program Level": "Master", "Related Program Name": "M1 : Ingénierie de l’environnement et des territoires (IET)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Université de Liège Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Master's programs in Chemical engineering and processes/Food processing", "International Agreement": "Erasmus+", "latitude": 50.5597273, "longitude": 4.69431267 },
            { "Related Program Level": "Master", "Related Program Name": "M2 : Gestion Durable de l’Environnement (GDE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Chalmers University of Technology", "Partner Country": "Sweden", "Partner City": "Gothenburg", "Partner Program": "Master's programs in Food processing and Chemistry", "International Agreement": "Erasmus+", "latitude": 57.7072326, "longitude": 11.9670171 },
            { "Related Program Level": "Master", "Related Program Name": "M2 : Gestion Durable de l’Environnement (GDE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.18001327 },
            { "Related Program Level": "Master", "Related Program Name": "M2 : Gestion Durable de l’Environnement (GDE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Université de Liège Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Master's programs in Chemical engineering and processes/Food processing", "International Agreement": "Erasmus+", "latitude": 50.5597273, "longitude": 4.69431267 },
            { "Related Program Level": "Master", "Related Program Name": "Géologie Appliquée (3 G)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Chemistry and Technology UCT Prague", "Partner Country": "Czech Republic", "Partner City": "Prague", "Partner Program": "Master's programs in Natural sciences, mathematics and statistics/Engineering, manufacturing and construction", "International Agreement": "Erasmus+", "latitude": 50.0874654, "longitude": 14.4212535 },
            { "Related Program Level": "Master", "Related Program Name": "Géologie Appliquée (3 G)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Technische Universität Kaiserslautern", "Partner Country": "Germany", "Partner City": "Kaiserslautern", "Partner Program": "Master's programs in Information and Communication, Electronics and automation, Mathematics, Physics, Chemistry", "International Agreement": "Erasmus+", "latitude": 49.4432174, "longitude": 7.76899517 },
            { "Related Program Level": "Master", "Related Program Name": "Behavioral and Digital Economics for Effective Management (BDEEM)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Haliç University", "Partner Country": "Turkey", "Partner City": "Istanbul", "Partner Program": "Master's programs in Business and administration", "International Agreement": "Erasmus+", "latitude": 41.0063817, "longitude": 28.9758715 },
            { "Related Program Level": "Master", "Related Program Name": "International Master in Microbiology: For the Microbes", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Université Johannes Gutenberg (JGU)", "Partner Institution": "Yerevan State University", "Partner Country": "Armenia", "Partner City": "Yerevan", "Partner Program": "Master's in Biology and Physico-Chemistry", "International Agreement": "Double degree", "latitude": 40.1777112, "longitude": 44.5126233 },
            { "Related Program Level": "Master", "Related Program Name": "International Master in Microbiology: For the Microbes", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Université Johannes Gutenberg (JGU)", "Partner Institution": "University of Chemistry and Technology UCT Prague", "Partner Country": "Czech Republic", "Partner City": "Prague", "Partner Program": "Master's programs in Natural sciences, mathematics and statistics/Engineering, manufacturing and construction", "International Agreement": "Erasmus+", "latitude": 50.0874654, "longitude": 14.4212535 },
            { "Related Program Level": "Master", "Related Program Name": "Agroécologie : Agrosciences, Environnement, Territoire, Paysage, Forêt", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.18001327 },
            { "Related Program Level": "Master", "Related Program Name": "Agroécologie : Agrosciences, Environnement, Territoire, Paysage, Forêt", "Related Institution": "Université Marie & Louis Pasteur (UMLP), Institut Agro Dijon (IAD)", "Partner Institution": "Université de Liège Gembloux Agro-Bio Tech", "Partner Country": "Belgium", "Partner City": "Gembloux", "Partner Program": "Master's programs in Chemical engineering and processes/Food processing", "International Agreement": "Erasmus+", "latitude": 50.5597273, "longitude": 4.69431267 },
            { "Related Program Level": "Master", "Related Program Name": "Changement Climatique, Adaptation, Territoires (CCLIMAT)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Chalmers University of Technology", "Partner Country": "Sweden", "Partner City": "Gothenburg", "Partner Program": "Master's programs in Food processing and Chemistry", "International Agreement": "Erasmus+", "latitude": 57.7072326, "longitude": 11.9670171 },
            { "Related Program Level": "Master", "Related Program Name": "Changement Climatique, Adaptation, Territoires (CCLIMAT)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.18001327 },
            { "Related Program Level": "Master", "Related Program Name": "Aide à la décision, Géomatique et Aménagement pour une Transition Écologique (AGATE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Chalmers University of Technology", "Partner Country": "Sweden", "Partner City": "Gothenburg", "Partner Program": "Master's programs in Food processing and Chemistry", "International Agreement": "Erasmus+", "latitude": 57.7072326, "longitude": 11.9670171 },
            { "Related Program Level": "Master", "Related Program Name": "Aide à la décision, Géomatique et Aménagement pour une Transition Écologique (AGATE)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Universität Hohenheim", "Partner Country": "Germany", "Partner City": "Stuttgart", "Partner Program": "Master's programs in Food processing", "International Agreement": "Erasmus+", "latitude": 48.7784485, "longitude": 9.18001327 },
            { "Related Program Level": "Master", "Related Program Name": "Dynamique et Conservation de la Biodiversité (DyCoB)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "Yerevan State University", "Partner Country": "Armenia", "Partner City": "Yerevan", "Partner Program": "Master's in Biology and Physico-Chemistry", "International Agreement": "Double degree", "latitude": 40.1777112, "longitude": 44.5126233 },
            { "Related Program Level": "Master", "Related Program Name": "Dynamique et Conservation de la Biodiversité (DyCoB)", "Related Institution": "Université Marie & Louis Pasteur (UMLP)", "Partner Institution": "University of Chemistry and Technology UCT Prague", "Partner Country": "Czech Republic", "Partner City": "Prague", "Partner Program": "Master's programs in Natural sciences, mathematics and statistics/Engineering, manufacturing and construction", "International Agreement": "Erasmus+", "latitude": 50.0874654, "longitude": 14.4212535 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 1347 Agro-Ecology (AE)", "Related Institution": "INRAE; Institut Agro Dijon; UBFC", "Partner Institution": "University of Birmingham", "Partner Country": "United Kingdom", "Partner City": "Birmingham", "Partner Program": "Research on agricultural ecosystems", "International Agreement": "", "latitude": 52.4506089, "longitude": -2.0067922 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 6282 Biogeosciences (BGS)", "Related Institution": "CNRS; UBFC; EPHE", "Partner Institution": "ICA-CSIC", "Partner Country": "Spain", "Partner City": "Madrid", "Partner Program": "SENSAAS Project - Analytical methodologies for characterizing natural organic matter and microplastics", "International Agreement": "", "latitude": 40.4410737, "longitude": -3.6869937 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 6282 Biogeosciences (BGS)", "Related Institution": "CNRS; UBFC; EPHE", "Partner Institution": "COSTEL Lab", "Partner Country": "France", "Partner City": "Rennes", "Partner Program": "Collaborative project in biogeosciences", "International Agreement": "", "latitude": 48.1113387, "longitude": -1.6800198 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 6282 Biogeosciences (BGS)", "Related Institution": "CNRS; UBFC; EPHE", "Partner Institution": "PRODIG Lab", "Partner Country": "France", "Partner City": "Paris", "Partner Program": "Research in biogeosciences", "International Agreement": "", "latitude": 48.9089627, "longitude": 2.3668657 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 1041 Center for Economics and Sociology Applied to Agriculture and Rural Areas (CESAER)", "Related Institution": "INRAE; Institut Agro Dijon; UBFC", "Partner Institution": "Journal of Economic Geography (Oxford)", "Partner Country": "United Kingdom", "Partner City": "Oxford", "Partner Program": "Academic collaboration in economic geography", "International Agreement": "", "latitude": 51.7559287, "longitude": -1.2608967 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 6249 Chrono-environment (CE)", "Related Institution": "CNRS; UBFC", "Partner Institution": "Stazione Zoologica Anton Dohr", "Partner Country": "Italy", "Partner City": "Naples", "Partner Program": "Environmental research", "International Agreement": "", "latitude": 40.8329067, "longitude": 14.2333877 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR A 02.102 Food and Microbiological Processes (PAM)", "Related Institution": "Institut Agro Dijon; UBFC; INRAE", "Partner Institution": "University of Madrid", "Partner Country": "Spain", "Partner City": "Madrid", "Partner Program": "Research on food processes", "International Agreement": "", "latitude": 40.4435813, "longitude": -3.7282369 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 6049 Theorizing and Modeling for Planning (ThéMA)", "Related Institution": "CNRS; UBFC", "Partner Institution": "ISSW (International Snow Science Workshop)", "Partner Country": "Austria", "Partner City": "Innsbruck", "Partner Program": "Research on snow", "International Agreement": "", "latitude": 47.2654296, "longitude": 11.3927685 },
            { "Related Program Level": "Laboratory", "Related Program Name": "UMR 6049 Theorizing and Modeling for Planning (ThéMA)", "Related Institution": "CNRS; UBFC", "Partner Institution": "University of Bourgogne Franche-Comté", "Partner Country": "France", "Partner City": "Dijon", "Partner Program": "MOBilities of e-Shopping (MOBS)", "International Agreement": "", "latitude": 47.3215806, "longitude": 5.0414701 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 3190 Center for Research on Economic Strategies (CRESE)", "Related Institution": "University of Franche-Comté", "Partner Institution": "University of Haute-Alsace", "Partner Country": "France", "Partner City": "Mulhouse", "Partner Program": "Research on discrimination in the housing market", "International Agreement": "", "latitude": 47.7467233, "longitude": 7.3389937 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 3190 Center for Research on Economic Strategies (CRESE)", "Related Institution": "University of Franche-Comté", "Partner Institution": "University of Bourgogne-Franche-Comté", "Partner Country": "France", "Partner City": "Dijon", "Partner Program": "Economic strategies and axiomatization", "International Agreement": "", "latitude": 47.3215806, "longitude": 5.0414701 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 7467 Dijon Economics Laboratory (LEDI)", "Related Institution": "University of Bourgogne", "Partner Institution": "University of Paris-Saclay", "Partner Country": "France", "Partner City": "Paris", "Partner Program": "Health economics research projects", "International Agreement": "", "latitude": 48.8534951, "longitude": 2.3483915 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 7467 Dijon Economics Laboratory (LEDI)", "Related Institution": "University of Bourgogne", "Partner Institution": "Joint Research Unit 1018", "Partner Country": "France", "Partner City": "Paris", "Partner Program": "Center for research in epidemiology and population health", "International Agreement": "", "latitude": 48.8534951, "longitude": 2.3483915 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 7467 Dijon Economics Laboratory (LEDI)", "Related Institution": "University of Bourgogne", "Partner Institution": "IDEES (Identity and Differentiation of Space; Environment; and Societies)", "Partner Country": "France", "Partner City": "Rouen", "Partner Program": "Green land uses in urban regions project", "International Agreement": "", "latitude": 49.4404591, "longitude": 1.0939658 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 7317 Center for Research in Organizational Management (CREGO)", "Related Institution": "University of Bourgogne; University of Franche-Comté; University of Haute-Alsace", "Partner Institution": "University of Haute-Alsace", "Partner Country": "France", "Partner City": "Mulhouse", "Partner Program": "Research in management sciences", "International Agreement": "", "latitude": 47.7467233, "longitude": 7.3389937 },
            { "Related Program Level": "Laboratory", "Related Program Name": "EA 7317 Center for Research in Organizational Management (CREGO)", "Related Institution": "University of Bourgogne; University of Franche-Comté; University of Haute-Alsace", "Partner Institution": "University of Bourgogne-Franche-Comté", "Partner Country": "France", "Partner City": "Dijon", "Partner Program": "Research in organizational governance", "International Agreement": "", "latitude": 47.3215806, "longitude": 5.0414701 }
        ];

        // Initialize the map
        const map = L.map('map').setView([50.0, 10.0], 3);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '© OpenStreetMap'
        }).addTo(map);

        // Group markers by coordinates
        const markerGroups = {};
        partners.forEach(partner => {
            const key = `${partner.latitude},${partner.longitude}`;
            if (!markerGroups[key]) {
                markerGroups[key] = [];
            }
            markerGroups[key].push(partner);
        });

        // Add markers with popups
        Object.entries(markerGroups).forEach(([key, partnersAtLocation]) => {
            const [lat, lng] = key.split(',');
            const marker = L.marker([parseFloat(lat), parseFloat(lng)]).addTo(map);
            const popupContent = `
                <div class="popup-content">
                    ${partnersAtLocation.map(p => `
                        <div>
                            <strong>${p["Partner Institution"]}</strong><br>
                            City: ${p["Partner City"]}<br>
                            Country: ${p["Partner Country"]}<br>
                            Program: ${p["Related Program Name"]}<br>
                            Agreement: ${p["International Agreement"] || 'N/A'}
                        </div>
                        <hr>
                    `).join('')}
                </div>
            `;
            marker.bindPopup(popupContent);
        });

        // Filter functionality
        document.getElementById('programLevelFilter').addEventListener('change', updateMap);
        document.getElementById('countryFilter').addEventListener('change', updateMap);
        document.getElementById('agreementTypeFilter').addEventListener('change', updateMap);

        function updateMap() {
            const programLevel = document.getElementById('programLevelFilter').value;
            const country = document.getElementById('countryFilter').value;
            const agreementType = document.getElementById('agreementTypeFilter').value;

            map.eachLayer(layer => {
                if (layer instanceof L.Marker) {
                    map.removeLayer(layer);
                }
            });

            const filteredPartners = partners.filter(partner => {
                return (programLevel === 'all' || partner["Related Program Level"] === programLevel) &&
                       (country === 'all' || partner["Partner Country"] === country) &&
                       (agreementType === 'all' || partner["International Agreement"] === agreementType);
            });

            const newMarkerGroups = {};
            filteredPartners.forEach(partner => {
                const key = `${partner.latitude},${partner.longitude}`;
                if (!newMarkerGroups[key]) {
                    newMarkerGroups[key] = [];
                }
                newMarkerGroups[key].push(partner);
            });

            Object.entries(newMarkerGroups).forEach(([key, partnersAtLocation]) => {
                const [lat, lng] = key.split(',');
                const marker = L.marker([parseFloat(lat), parseFloat(lng)]).addTo(map);
                const popupContent = `
                    <div class="popup-content">
                        ${partnersAtLocation.map(p => `
                            <div>
                                <strong>${p["Partner Institution"]}</strong><br>
                                City: ${p["Partner City"]}<br>
                                Country: ${p["Partner Country"]}<br>
                                Program: ${p["Related Program Name"]}<br>
                                Agreement: ${p["International Agreement"] || 'N/A'}
                            </div>
                            <hr>
                        `).join('')}
                    </div>
                `;
                marker.bindPopup(popupContent);
            });
        }
    </script>
</body>
</html>

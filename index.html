<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Transbio Graduate School - Partenaires Internationaux</title>
  
  <!-- External Libraries -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <!-- Custom Styles -->
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      color: #333;
      background-color: #f8f8f8;
    }
    .section-title {
      font-size: 1.8rem;
      font-weight: 600;
      color: #004080;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid rgba(0, 0, 0, 0.1);
    }
    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    #map {
      height: 500px;
      width: 100%;
      border: 2px solid #ccc;
      border-radius: 8px;
    }
    .filter-container {
      background-color: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .news-date {
      font-size: 0.8rem;
      color: #666;
      font-weight: 500;
    }
    .btn-primary {
      background-color: #004080;
      color: white;
      padding: 8px 15px;
      border-radius: 4px;
      font-weight: 500;
      display: inline-block;
      transition: background-color 0.3s ease;
    }
    .btn-primary:hover {
      background-color: #00305f;
    }
    footer {
      background-color: #004080;
      color: white;
    }
    @media print {
      .container {
        width: 100%;
        max-width: 100%;
      }
      #map {
        height: 400px;
        page-break-inside: avoid;
      }
      section {
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- Header -->
  <header class="bg-blue-900 text-white">
    <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold">Transbio Graduate School</h1>
        <p class="text-sm text-blue-200">L'excellence dans la recherche et l'éducation</p>
      </div>
      <nav class="mt-4 md:mt-0">
        <ul class="flex space-x-6">
          <li><a href="#map-section" class="hover:text-blue-200 font-medium">Carte des partenaires</a></li>
          <li><a href="#networks" class="hover:text-blue-200 font-medium">Réseaux</a></li>
          <li><a href="#international" class="hover:text-blue-200 font-medium">International</a></li>
          <li><a href="#studying-abroad" class="hover:text-blue-200 font-medium">Étudier à l'étranger</a></li>
          <li><a href="#news" class="hover:text-blue-200 font-medium">Actualités</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <div class="bg-blue-800 text-white py-10">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl font-bold mb-4">Partenaires Internationaux</h2>
      <p class="text-xl mb-6">Découvrez notre réseau mondial de partenaires académiques et institutionnels</p>
      <p class="text-blue-200 max-w-3xl">Transbio Graduate School s'engage à construire des partenariats solides avec des institutions du monde entier pour offrir des possibilités d'échange et de collaboration pour nos étudiants, chercheurs et enseignants.</p>
    </div>
  </div>

  <!-- Main Content -->
  <main class="flex-grow">
    <div class="container mx-auto px-4 py-8">
      <!-- Map Section -->
      <section id="map-section" class="mb-16">
        <h2 class="section-title">Carte interactive des institutions partenaires</h2>
        <p class="mb-4">Explorez les partenariats internationaux de la Graduate School Transbio à travers le monde. Utilisez les filtres ci-dessous pour affiner votre recherche.</p>
        <div class="flex flex-col md:flex-row gap-6">
          <!-- Filters -->
          <div class="w-full md:w-1/4">
            <div class="filter-container">
              <h3 class="text-lg font-medium text-blue-800 mb-4">Filtres</h3>
              <div class="mb-4">
                <label for="typeFilter" class="block text-sm font-medium text-gray-700 mb-1">Type :</label>
                <select id="typeFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="" selected>Tous</option>
                </select>
              </div>
              <div class="mb-4" id="programLabFilterContainer" style="display: none;">
                <label for="programLabFilter" class="block text-sm font-medium text-gray-700 mb-1">Programme/Laboratoire :</label>
                <select id="programLabFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="" selected>Tous</option>
                </select>
              </div>
              <div class="mb-4">
                <label for="agreementFilter" class="block text-sm font-medium text-gray-700 mb-1">Type d'accord :</label>
                <select id="agreementFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="" selected>Tous</option>
                </select>
              </div>
              <div class="mb-4">
                <label for="countryFilter" class="block text-sm font-medium text-gray-700 mb-1">Pays partenaire :</label>
                <select id="countryFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="" selected>Tous</option>
                </select>
              </div>
              <p class="text-sm text-gray-600 mt-6">La carte affiche tous nos partenariats actifs. Cliquez sur un marqueur pour plus de détails.</p>
            </div>
          </div>
          <!-- Map -->
          <div class="w-full md:w-3/4">
            <div id="map"></div>
          </div>
        </div>
      </section>

      <!-- Networks Section -->
      <section id="networks" class="mb-16">
        <h2 class="section-title">Réseaux</h2>
        <p class="mb-6">Des partenariats soigneusement sélectionnés soutiennent le partage des connaissances et la coopération dans l'éducation et la recherche.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <div class="card bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-3">Collaborations académiques</h3>
            <p class="text-gray-700 mb-4">Échanges avec des universités de premier plan.</p>
            <span class="text-sm font-medium text-blue-600">150+ partenaires</span>
          </div>
          <div class="card bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-3">Partenariats industriels</h3>
            <p class="text-gray-700 mb-4">Projets avec des entreprises pour la recherche appliquée.</p>
            <span class="text-sm font-medium text-blue-600">75+ partenaires</span>
          </div>
          <div class="card bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-3">Réseaux de recherche</h3>
            <p class="text-gray-700 mb-4">Participation à des consortiums internationaux.</p>
            <span class="text-sm font-medium text-blue-600">25 réseaux</span>
          </div>
        </div>
      </section>

      <!-- International Section -->
      <section id="international" class="mb-16">
        <h2 class="section-title">International</h2>
        <p class="mb-6">Transbio opère globalement, renforçant la coopération avec des partenaires étrangers.</p>
        <div class="bg-white p-6 rounded-lg shadow-md mb-6">
          <h3 class="text-xl font-semibold text-blue-800 mb-3">Notre vision</h3>
          <p class="text-gray-700">Nous collaborons mondialement tout en valorisant notre rôle régional.</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-3">Programmes</h3>
            <ul class="list-disc pl-5 space-y-2 text-gray-700">
              <li>Échanges étudiants</li>
              <li>Écoles d'été</li>
              <li>Double diplômes</li>
              <li>Ateliers internationaux</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-3">Ressources</h3>
            <ul class="list-disc pl-5 space-y-2 text-gray-700">
              <li>Bureau international</li>
              <li>Cours de langues</li>
              <li>Accueil étudiants</li>
              <li>Mentorat interculturel</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Studying Abroad Section -->
      <section id="studying-abroad" class="mb-16">
        <h2 class="section-title">Mobilité internationale</h2>
        <p class="mb-6">Transbio favorise la mobilité des étudiants et du personnel vers nos partenaires.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-4">Étudiants</h3>
            <ul class="list-disc pl-5 space-y-2 text-gray-700 mb-6">
              <li>Semestre d'échange</li>
              <li>Stages</li>
              <li>Projets de recherche</li>
            </ul>
            <a href="#" class="btn-primary">En savoir plus</a>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-blue-800 mb-4">Personnel</h3>
            <ul class="list-disc pl-5 space-y-2 text-gray-700 mb-6">
              <li>Séjours de recherche</li>
              <li>Enseignement</li>
              <li>Conférences</li>
            </ul>
            <a href="#" class="btn-primary">En savoir plus</a>
          </div>
        </div>
        <div class="bg-blue-50 p-6 rounded-lg">
          <h3 class="text-xl font-semibold text-blue-800 mb-4">Témoignages</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-4 rounded-lg shadow-sm">
              <p class="italic text-gray-700 mb-2">"Édimbourg a transformé ma vision."</p>
              <p class="font-medium">Marie L.</p>
            </div>
            <div class="bg-white p-4 rounded-lg shadow-sm">
              <p class="italic text-gray-700 mb-2">"Stockholm a boosté ma carrière."</p>
              <p class="font-medium">Thomas B.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- News Section -->
      <section id="news" class="mb-16">
        <h2 class="section-title">Actualités</h2>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div>
            <h3 class="text-xl font-semibold text-blue-800 mb-4">Nouvelles</h3>
            <div class="space-y-6">
              <div class="bg-white p-5 rounded-lg shadow-md">
                <span class="news-date">15/04/2025</span>
                <h4 class="text-lg font-medium text-blue-900 mt-1 mb-2">Partenariat avec Helsinki</h4>
                <p class="text-gray-700 mb-3">Nouveau partenariat pour des échanges et recherches.</p>
                <a href="#" class="text-blue-600 hover:underline">Lire</a>
              </div>
              <div class="bg-white p-5 rounded-lg shadow-md">
                <span class="news-date">28/03/2025</span>
                <h4 class="text-lg font-medium text-blue-900 mt-1 mb-2">Succès à Edinburgh</h4>
                <p class="text-gray-700 mb-3">Record d'étudiants dans le programme d'échange.</p>
                <a href="#" class="text-blue-600 hover:underline">Lire</a>
              </div>
            </div>
          </div>
          <div>
            <h3 class="text-xl font-semibold text-blue-800 mb-4">Événements</h3>
            <div class="space-y-6">
              <div class="bg-white p-5 rounded-lg shadow-md">
                <span class="news-date">20/05/2025</span>
                <h4 class="text-lg font-medium text-blue-900 mt-1 mb-2">Journée partenaires</h4>
                <p class="text-gray-700 mb-3">Présentation des opportunités. Campus Besançon.</p>
                <a href="#" class="btn-primary">S'inscrire</a>
              </div>
              <div class="bg-white p-5 rounded-lg shadow-md">
                <span class="news-date">15/06/2025</span>
                <h4 class="text-lg font-medium text-blue-900 mt-1 mb-2">Webinaire mobilité</h4>
                <p class="text-gray-700 mb-3">14h-16h en ligne.</p>
                <a href="#" class="btn-primary">S'inscrire</a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="py-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-xl font-bold mb-4">Transbio Graduate School</h3>
          <p class="text-blue-200 mb-4">Excellence en sciences du vivant.</p>
        </div>
        <div>
          <h4 class="font-bold mb-4">Contact</h4>
          <ul class="space-y-2 text-blue-200">
            <li>Bureau international</li>
            <li>Campus Besançon</li>
            <li><a href="mailto:international@transbio.edu">international@transbio.edu</a></li>
            <li>Tél: +33 3 81 XX XX XX</li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-4">Liens</h4>
          <ul class="space-y-2">
            <li><a href="#map-section" class="text-blue-200 hover:text-white">Carte</a></li>
            <li><a href="#networks" class="text-blue-200 hover:text-white">Réseaux</a></li>
            <li><a href="#international" class="text-blue-200 hover:text-white">International</a></li>
            <li><a href="#studying-abroad" class="text-blue-200 hover:text-white">Mobilité</a></li>
            <li><a href="#news" class="text-blue-200 hover:text-white">Actualités</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-4">Suivez-nous</h4>
          <div class="flex space-x-4">
            <a href="#" class="text-blue-200 hover:text-white">Twitter</a>
            <a href="#" class="text-blue-200 hover:text-white">LinkedIn</a>
            <a href="#" class="text-blue-200 hover:text-white">Facebook</a>
            <a href="#" class="text-blue-200 hover:text-white">Instagram</a>
          </div>
        </div>
      </div>
      <div class="mt-8 pt-6 border-t border-blue-700">
        <p class="text-center text-blue-200">© 2025 Transbio Graduate School. Tous droits réservés.</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script>
    // Initialize map
    const map = L.map('map').setView([45, 3], 3);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
      attribution: '© OpenStreetMap contributors © CARTO',
      subdomains: 'abcd',
      maxZoom: 20
    }).addTo(map);

    let markers = [];
    let data = [];

    // City coordinates
    const cityCoordinates = {
      "Stuttgart": [48.7758, 9.1829],
      "Gembloux": [50.5612, 4.6981],
      "Valencia": [39.4699, -0.3763],
      "Bonn": [50.7374, 7.0982],
      "Córdoba": [37.8882, -4.7794],
      "Vienna": [48.2082, 16.3738],
      "Helsinki": [60.1699, 24.9384],
      "Ghent": [51.0543, 3.7174],
      "Zagreb": [45.8150, 15.9819],
      "Barcelona": [41.3851, 2.1734],
      "Gothenburg": [57.7089, 11.9746],
      "Yerevan": [40.1872, 44.5152],
      "Prague": [50.0755, 14.4378],
      "Kaiserslautern": [49.4447, 7.7689],
      "Istanbul": [41.0082, 28.9784],
      "Rostock": [54.0924, 12.0991],
      "Ljubljana": [46.0569, 14.5058],
      "Bucharest": [44.4268, 26.1025],
      "Birmingham": [52.4862, -1.8904],
      "Madrid": [40.4168, -3.7038],
      "Rennes": [48.1173, -1.6778],
      "Paris": [48.8566, 2.3522],
      "Oxford": [51.7520, -1.2577],
      "Naples": [40.8518, 14.2681],
      "Innsbruck": [47.2692, 11.4041],
      "Dijon": [47.3220, 5.0415],
      "Mulhouse": [47.7508, 7.3359],
      "Rouen": [49.4432, 1.0999]
    };

    // Load CSV data
    async function loadData() {
      try {
        const masterCsv = await (await fetch("Relations Internationales des Masters - Données.csv")).text();
        const labCsv = await (await fetch("International_Relations_Transbio.csv")).text();

        Papa.parse(masterCsv, {
          header: true,
          skipEmptyLines: true,
          complete: (masterResults) => {
            const masterData = masterResults.data.map(row => ({
              Type: "Master",
              Name: row["Related Program Name"] || "",
              RelatedInstitution: row["Related Institution"] || "",
              PartnerInstitution: row["Partner Institution"] || "",
              PartnerCountry: row["Partner Country"] || "",
              PartnerCity: row["Partner City"] || "",
              PartnerProgram: row["Partner Program"] || "",
              Agreement: row["International Agreement"] || "",
              Source: row["Source"] || "",
              Latitude: cityCoordinates[row["Partner City"]] ? cityCoordinates[row["Partner City"]][0] : 0,
              Longitude: cityCoordinates[row["Partner City"]] ? cityCoordinates[row["Partner City"]][1] : 0
            })).filter(row => row.Latitude && row.Longitude);

            Papa.parse(labCsv, {
              header: true,
              skipEmptyLines: true,
              complete: (labResults) => {
                const labData = labResults.data.map(row => ({
                  Type: "Laboratory",
                  Name: row["Laboratory"] || "",
                  RelatedInstitution: row["Related Institution"] || "",
                  PartnerInstitution: row["Partner Institution"] || "",
                  PartnerCountry: row["Partner Country"] || "",
                  PartnerCity: row["Partner City"] || "",
                  PartnerProgram: row["Partner Program"] || "",
                  Agreement: "",
                  Source: "",
                  Latitude: cityCoordinates[row["Partner City"]] ? cityCoordinates[row["Partner City"]][0] : 0,
                  Longitude: cityCoordinates[row["Partner City"]] ? cityCoordinates[row["Partner City"]][1] : 0
                })).filter(row => row.Latitude && row.Longitude);

                data = [...masterData, ...labData];
                console.log("Data loaded:", data);
                populateFilters();
                updateMap();
              },
              error: (err) => console.error("Lab CSV error:", err)
            });
          },
          error: (err) => console.error("Master CSV error:", err)
        });
      } catch (err) {
        console.error("Fetch error:", err);
      }
    }

    // Populate filters
    function populateFilters() {
      const types = new Set(["", "Master", "Laboratory"]);
      const agreements = new Set([""]);
      const countries = new Set([""]);
      const namesByType = { Master: new Set(), Laboratory: new Set() };

      data.forEach(item => {
        types.add(item.Type);
        if (item.Name) namesByType[item.Type].add(item.Name);
        if (item.Agreement) agreements.add(item.Agreement);
        if (item.PartnerCountry) countries.add(item.PartnerCountry);
      });

      fillSelect("typeFilter", types, "Tous");
      fillSelect("agreementFilter", agreements, "Tous");
      fillSelect("countryFilter", countries, "Tous");

      const typeFilter = document.getElementById("typeFilter");
      const programLabFilter = document.getElementById("programLabFilter");
      const programLabContainer = document.getElementById("programLabFilterContainer");

      typeFilter.addEventListener("change", () => {
        const type = typeFilter.value;
        programLabFilter.innerHTML = '<option value="" selected>Tous</option>';
        programLabContainer.style.display = type ? "block" : "none";
        if (type && namesByType[type]) {
          Array.from(namesByType[type]).sort().forEach(name => {
            const option = document.createElement("option");
            option.value = name;
            option.text = name;
            programLabFilter.appendChild(option);
          });
        }
        updateMap();
      });
    }

    // Fill select elements
    function fillSelect(id, values, defaultText) {
      const select = document.getElementById(id);
      select.innerHTML = `<option value="" selected>${defaultText}</option>`;
      Array.from(values).sort().forEach(val => {
        if (val) {
          const option = document.createElement("option");
          option.value = val;
          option.text = val === "Master" ? "Master" : val === "Laboratory" ? "Laboratoire" : val;
          select.appendChild(option);
        }
      });
    }

    // Update map
    function updateMap() {
      markers.forEach(marker => map.removeLayer(marker));
      markers = [];

      const type = document.getElementById("typeFilter").value;
      const programLab = document.getElementById("programLabFilter").value;
      const agreement = document.getElementById("agreementFilter").value;
      const country = document.getElementById("countryFilter").value;

      const filteredData = data.filter(item => {
        return (!type || item.Type === type) &&
               (!programLab || item.Name === programLab) &&
               (!agreement || item.Agreement === agreement) &&
               (!country || item.PartnerCountry === country) &&
               item.Latitude && item.Longitude;
      });

      filteredData.forEach(item => {
        const lat = parseFloat(item.Latitude);
        const lng = parseFloat(item.Longitude);
        if (!isNaN(lat) && !isNaN(lng)) {
          const marker = L.marker([lat, lng]).addTo(map);
          const popupContent = item.Type === "Master" ? `
            <b>${item.Name}</b><br>
            <b>Institution:</b> ${item.RelatedInstitution}<br>
            <b>Partenaire:</b> ${item.PartnerInstitution}<br>
            <b>Pays:</b> ${item.PartnerCountry}<br>
            <b>Ville:</b> ${item.PartnerCity}<br>
            <b>Accord:</b> ${item.Agreement}<br>
            <a href="${item.Source}" target="_blank">Plus</a>
          ` : `
            <b>${item.Name}</b><br>
            <b>Institution:</b> ${item.RelatedInstitution}<br>
            <b>Partenaire:</b> ${item.PartnerInstitution}<br>
            <b>Pays:</b> ${item.PartnerCountry}<br>
            <b>Ville:</b> ${item.PartnerCity}
          `;
          marker.bindPopup(popupContent);
          markers.push(marker);
        }
      });
    }

    // Event listeners
    document.getElementById("typeFilter").addEventListener("change", updateMap);
    document.getElementById("programLabFilter").addEventListener("change", updateMap);
    document.getElementById("agreementFilter").addEventListener("change", updateMap);
    document.getElementById("countryFilter").addEventListener("change", updateMap);

    // Load data on page load
    window.addEventListener("DOMContentLoaded", loadData);
  </script>
</body>
</html>
